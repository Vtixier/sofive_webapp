<!DOCTYPE html>
<html>

<head>

    <meta charset="utf-8">

    <title>Sofive Soccer Center</title>

    <meta name="viewport" content="width=device-width, initial-scale = 1, minimum-scale = 1, maximum-scale = 1, user-scalable = no" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <link rel="apple-touch-icon" href="https://sofive.com/wp-content/uploads/2018/04/cropped-sigle-192x192.png" />
    <link rel="apple-touch-icon" sizes="72x72" href="https://sofive.com/wp-content/uploads/2018/04/cropped-sigle-192x192.png" />
    <link rel="apple-touch-icon" sizes="114x114" href="https://sofive.com/wp-content/uploads/2018/04/cropped-sigle-192x192.png" />
    <meta name="apple-mobile-web-app-title" content="Sofive">
    <style type="text/css">
        body {
            -webkit-user-select: none;
            -webkit-tap-highlight-color: transparent;
            -webkit-touch-callout: none;
        }
    </style>


    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="font-awesome/css/font-awesome.css" rel="stylesheet">
    <link href="css/animate.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">
    <link rel="icon" href="https://sofive.com/wp-content/uploads/2018/04/cropped-sigle-32x32.png" sizes="32x32" />
    <link rel="icon" href="https://sofive.com/wp-content/uploads/2018/04/cropped-sigle-192x192.png" sizes="192x192" />

    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-KHK4JK2');</script>

</head>

<body class="fixed-sidebar">

    <div id="wrapper">

        <div>
            <sofive-left-menu />
        </div>


        <div id="page-wrapper" class="gray-bg">

            <div>
                <sofive-header />
            </div>

            <div class="row" style="text-align: center; background-color: rgba(232, 232, 232, 0.43); border: 1px solid #e6eaec;">
                <div class="col-lg-12">
                    <div class="ibox" style="margin-top: 2%; margin-bottom: 2%">
                        <h1 style="color: #676a6c">View all nominated <strong> <span style="color: #03793e"> <i>goals of the month</i></span> </strong> !</h1>
                        <h3>{{moment().format("MMM YYYY")}}</h3>
                    </div>
                </div>
            </div>

            <div class="row wrapper" style="width: 100%">
                <div class="col-lg-3" v-for="clip in clips">
                    <div class="ibox">
                        <div>
                            <div>
                                <div class="ibox-content profile-content">
                                    <div>{{clip.team_name}}</div>
                                </div>
                                <div class="ibox-content no-padding border-left-right">
                                    <iframe frameborder="0" :src="clip.url" allowfullscreen style="width: 100%"></iframe>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <sofive-footer />
        </div>
    </div>

    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KHK4JK2"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    

    <!-- Mainly scripts -->
    <script src="js/jquery-3.1.1.min.js"></script>
    <script src="js/popper.min.js"></script>
    <script src="js/bootstrap.js"></script>
    <script src="js/plugins/metisMenu/jquery.metisMenu.js"></script>
    <script src="js/plugins/slimscroll/jquery.slimscroll.min.js"></script>

    <!-- Custom and plugin javascript -->
    <script src="js/inspinia.js"></script>

    <script src="js/vue.js"></script>

    <script type="text/javascript" src="js/vue-resource.js"></script>
    <script type="text/javascript" src="js/moment.js"></script>

    <script type="text/javascript" src="js/navigation.js"></script>
    <script type="text/javascript" src="js/header.js"></script>
    <script type="text/javascript" src="js/footer.js"></script>

    <script type="text/javascript">
        var app = new Vue({
            el: '#wrapper',
            data: {
                clips: []
            },
            mounted: function() {
                this.getVideos()
            },
            methods: {
                getVideos: function() {
                    const date = moment(),
                    month = parseInt(date.format("MM")),
                    year = parseInt(date.format("YYYY")),
                    self = this;
                    return this.$http.post("https://video.scoreplay.io/gotm/get", {
                        month, year,
                    }).then(resp => {
                        self.clips = resp.data.map(v => ({
                            ...v,
                            url: v.url.replace("/video/", "/embed/video/")
                        }))
                        return Promise.all(self.clips.map(self.getSingleMatchDetails))
                        .then(vids => {
                            self.clips = vids
                        })
                    })
                },
                getSingleMatchDetails: function(match) {
                        console.log("Getting details", match)
                        const match_id = match.match_id.toString();
                        return this.$http.post("https://app.scoreplay.io/match/details", {
                                match_id
                            })
                            .then(function(resp) {
                                console.log(resp)
                                let body = resp.body,
                                team_name = "Rental team"
                                if (match_id.indexOf("manual") === (-1)) {
                                    if (match.side === "away") {
                                        team_name = body.details.away.teamName
                                    } else {
                                        team_name = body.details.home.teamName
                                    }
                                    team_name += " ("+body.details.type+")"
                                }
                                return {
                                    team_name,
                                    ...match,
                                }
                            })
                    },
            }
        })
    </script>

</body>

</html>